<!DOCTYPE html>
<html>
<body>
<button id="start">Start Stream</button>

<script>
const ws = new WebSocket("ws://localhost:3000"); // Your WebSocket server
ws.binaryType = "arraybuffer";

document.getElementById("start").onclick = async () => {
  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
  const recorder = new MediaRecorder(stream, {
    mimeType: "audio/webm;codecs=opus",
    audioBitsPerSecond: 64000, // adjust quality (32kâ€“128k typical)
  });

  recorder.ondataavailable = e => {
    if (e.data.size > 0 && ws.readyState === WebSocket.OPEN) {
      e.data.arrayBuffer().then(buf => ws.send(buf));
    }
  };

  recorder.start(250); // send small chunks every 250ms
  console.log("Streaming microphone via WebSocket...");
};
</script>
</body>
</html>

